services:
  recon-daemon:
    environment:
      - RECOND_RUN_MS=3000
    command: ["aeron:udp?endpoint=aeron-media-driver:20121", "1001", "aeron:udp?endpoint=aeron-media-driver:20122", "1002"]

  aeron-publisher:
    build: ..
    image: fx-recon:latest
    depends_on:
      - aeron-media-driver
    networks:
      - recon-net
    environment:
      - AERON_DIR=/var/tmp/aeron
    volumes:
      - aeron-md-data:/var/tmp/aeron
    entrypoint: ["/bin/sh", "-c"]
    command: >
      /usr/local/bin/fx_aeron_publisher "aeron:udp?endpoint=aeron-media-driver:20121" 1001 8 10 &&
      /usr/local/bin/fx_aeron_publisher "aeron:udp?endpoint=aeron-media-driver:20122" 1002 8 10 &&
      sleep 1
